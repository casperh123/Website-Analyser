@using WebsiteAnalyzer.Core.Entities.Website
@using WebsiteAnalyzer.Core.Interfaces.Services
@using WebsiteAnalyzer.Infrastructure
@using WebsiteAnalyzer.Web.Services

@inherits ProcessingComponentBase

@inject IUserService UserService
@inject IWebsiteService WebsiteService

@code {
    [Parameter]
    public Guid WebsiteId { get; set; }
    
    protected Website? Website { get; set; }
    protected ApplicationUser? User { get; set; }
    protected ICollection<Website> Websites { get; set; }
    
    protected override async Task OnInitializedAsync()
    {
        await base.OnInitializedAsync();
        
        User = await UserService.GetCurrentUserAsync();
        
        if (User != null)
        {
            Website = await WebsiteService.GetWebsiteByIdAndUserId(WebsiteId, User.Id);
            Websites = await WebsiteService.GetWebsitesByUserId(User.Id);
        }
    }
}